#Working progress
#ENIGMA.UWU (si, deberia buscar un nombre mejor)
#Made by Airil
import random
import time
from termcolor import colored
import pyperclip #pip install pyperclip

#LISTA ORIGINAL#carRandomizar=("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "ñ", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", ",", ".", " ", "'", "!", "¡", "¿", "?", "·", "#", "/", "(", ")", "=", "+", "-", "_", "%", "€", "<", ">", "&", ":", ";", " ")
#LISTA ORIGINAL#caracteres=("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "ñ", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", ",", ".", " ", "'", "!", "¡", "¿", "?", "·", "#", "/", "(", ")", "=", "+", "-", "_", "%", "€", "<", ">", "&", ":", ";", " ", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "ñ", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", ",", ".", " ", "'", "!", "¡", "¿", "?", "·", "#", "/", "(", ")", "=", "+", "-", "_", "%", "€", "<", ">", "&", ":", ";", " ")
carRandomizar = ("8", "s", "¡", "6", "0", "5", "c", "ñ", "4", "!", "n", "p", "7", "m", "t", "u", "h", "i", "y", "€", "<", ">", "&", "3", ",", "f", "g", "h", "i", "y", "€", "<", ">", "&", "3", ",", ".", " ", "z", "1", "l", "a", "b", "¿", "?", "2", "'", "o", "j", "k", "+", "-", "_", "%", "v", "9", "q", "r", "w", "x", "d", ";", "e", ")", "=", "g", ":", " ")
caracteres = ("8", "s", "¡", "6", "0", "5", "c", "ñ", "4", "!", "n", "p", "7", "m", "t", "u", "h", "i", "y", "€", "<", ">", "&", "3", ",", "f", "g", "h", "i", "y", "€", "<", ">", "&", "3", ",", ".", " ", "z", "1", "l", "a", "b", "¿", "?", "2", "'", "o", "j", "k", "+", "-", "_", "%", "v", "9", "q", "r", "w", "x", "d", ";", "e", ")", "=", "g", ":", " ", 
              "8", "s", "¡", "6", "0", "5", "c", "ñ", "4", "!", "n", "p", "7", "m", "t", "u", "h", "i", "y", "€", "<", ">", "&", "3", ",", "f", "g", "h", "i", "y", "€", "<", ">", "&", "3", ",", ".", " ", "z", "1", "l", "a", "b", "¿", "?", "2", "'", "o", "j", "k", "+", "-", "_", "%", "v", "9", "q", "r", "w", "x", "d", ";", "e", ")", "=", "g", ":", " ")

while True:
    print(colored("\n[+] Eliga lo que quiere hacer:", 'green'), colored("\n-Encriptar", 'cyan'), colored("\n-Descifrar", 'cyan'))
    opcion = input(str(colored("[-] Opcion: ", 'yellow')))
    
    if opcion.lower() in ["encriptar", "e", "1"]:
        clave = list(input(colored("\n[-] Clave: ", 'yellow')))
        clave2 = clave.copy()

        for i in range(len(clave)): # randomizas la clave
            clave2[i] = carRandomizar[random.randint(0, len(carRandomizar)-1)]

        mensaje = list(input(colored("[-] Mensaje: ", 'yellow')))
        longMens = len(mensaje)

        trozos = len(clave) # calcular en cuántos trozos se encriptará individualmente
        parte = int(longMens/trozos)
        mensajeEncriptado = []

        for i in range(trozos):
            trozo = mensaje[i*parte:i*parte+parte]
            num0 = carRandomizar.index(clave2[i])
            num = num0 - carRandomizar.index(clave[i])
            trozoEncriptado = [caracteres[carRandomizar.index(letra) + num-1] for letra in trozo if letra in carRandomizar]
            mensajeEncriptado.extend(trozoEncriptado)

        mensajeEncriptado = "".join(clave2) + " " + "".join(mensajeEncriptado)
        pyperclip.copy(mensajeEncriptado[::-1])
        print(colored("\n[+] Mensaje encriptado: \n", 'green'), colored(mensajeEncriptado[::-1], 'cyan'), "\n") #lo imprime dado la vuelta para hacerlo un poco mas complicado de descifrar
        
    elif opcion.lower() == "descifrar" or opcion.lower() == "d":
        c1 = input(str(colored("\n[-] Clave: ", 'yellow')))
        clave = list(c1)
        clave2 = []
        
        mensaje = input(str(colored("[-] Mensaje encriptado: ", 'yellow')))
        mensaje = list(reversed(mensaje))
        dm = "" #mensaje desencriptado
        
        c = 0
        for i in range(len(clave)):
            clave2.append(mensaje[i-c])
            mensaje.remove(mensaje[i-c])
            c += 1
        mensaje.remove(" ")
        longMens = len(mensaje) 
        
        trozos = int(len(clave)) #calcular en cuantos trozos se encriptara individualmente
        parte = int(longMens/trozos)
        numTrozo = 0
        trozos = len(clave) # calcular en cuántos trozos se encriptó individualmente
        parte = int(longMens/trozos)
        inicio = 0

        for i in range(trozos): # decodificando
            trozo = mensaje[inicio:inicio+parte]
            num0 = carRandomizar.index(clave2[i])
            num = num0 - carRandomizar.index(clave[i])
            trozoDesencriptado = [carRandomizar[carRandomizar.index(letra) - num + 1] for letra in trozo if letra in carRandomizar]
            dm += "".join(trozoDesencriptado)
            inicio += parte

        print(colored("\n[+] Mensaje desencriptado: \n", 'green'), colored(dm, 'cyan'), "\n")
    
    else:
        print(colored("\n[!] ERROR: Vuelva a escribir lo que quiere hacer por favor.", 'red'))
