#Working progress
#ENIGMA.UWU (si, deberia buscar un nombre mejor)
#Made by Airil
import random
import time
from termcolor import colored

#LISTA ORIGINAL#carRandomizar=("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "ñ", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", ",", ".", " ", "'", "!", "¡", "¿", "?", "·", "#", "/", "(", ")", "=", "+", "-", "_", "%", "€", "<", ">", "&", ":", ";", " ")
#LISTA ORIGINAL#caracteres=("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "ñ", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", ",", ".", " ", "'", "!", "¡", "¿", "?", "·", "#", "/", "(", ")", "=", "+", "-", "_", "%", "€", "<", ">", "&", ":", ";", " ", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "ñ", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", ",", ".", " ", "'", "!", "¡", "¿", "?", "·", "#", "/", "(", ")", "=", "+", "-", "_", "%", "€", "<", ">", "&", ":", ";", " ")
carRandomizar = ("8", "s", "¡", "6", "0", "5", "c", "ñ", "4", "!", "n", "p", "7", "m", "t", "u", "h", "i", "y", "€", "<", ">", "&", "3", ",", "f", "g", "h", "i", "y", "€", "<", ">", "&", "3", ",", ".", " ", "z", "1", "l", "a", "b", "¿", "?", "2", "'", "o", "j", "k", "+", "-", "_", "%", "v", "9", "q", "r", "w", "x", "d", ";", "e", ")", "=", "g", ":", " ")
caracteres = ("8", "s", "¡", "6", "0", "5", "c", "ñ", "4", "!", "n", "p", "7", "m", "t", "u", "h", "i", "y", "€", "<", ">", "&", "3", ",", "f", "g", "h", "i", "y", "€", "<", ">", "&", "3", ",", ".", " ", "z", "1", "l", "a", "b", "¿", "?", "2", "'", "o", "j", "k", "+", "-", "_", "%", "v", "9", "q", "r", "w", "x", "d", ";", "e", ")", "=", "g", ":", " ", 
              "8", "s", "¡", "6", "0", "5", "c", "ñ", "4", "!", "n", "p", "7", "m", "t", "u", "h", "i", "y", "€", "<", ">", "&", "3", ",", "f", "g", "h", "i", "y", "€", "<", ">", "&", "3", ",", ".", " ", "z", "1", "l", "a", "b", "¿", "?", "2", "'", "o", "j", "k", "+", "-", "_", "%", "v", "9", "q", "r", "w", "x", "d", ";", "e", ")", "=", "g", ":", " ")

while True:
    print(colored("\n[+] Eliga lo que quiere hacer:", 'green'), colored("\n-Encriptar", 'cyan'), colored("\n-Descifrar", 'cyan'))
    opcion = input(str(colored("[-] Opcion: ", 'yellow')))
    
    if opcion.lower() == "encriptar" or opcion.lower() == "e" or opcion == "1":
        c1 = input(str(colored("\n[-] Clave: ", 'yellow')))
        clave = list(c1)
        clave2 = list(c1)
        
        ultLetra = 0
        ultLetra = 0
        for i in range(len(clave2)): #randomizas la clave
            clave2[ultLetra] = carRandomizar[random.randint(0, len(carRandomizar)-1)]
            ultLetra = ultLetra + 1

        mensaje = list(input(str(colored("[-] Mensaje: ", 'yellow'))))
        longMens = len(mensaje) 
        
        trozos = int(len(clave)) #calcular en cuantos trozos se encriptara individualmente
        parte = int(longMens/trozos)
        num = 0
        numTrozo = 0

        ultLetra = 0
        mensajeEncriptado = ""
        for a in range(longMens): #segun la posicion de la letra la encripta de una forma o de otra
            if mensaje[ultLetra] in carRandomizar:
                #posicion = a ver que formula me invento
                #o lo puedo hacer con un for XD
                for u in range(1, trozos+1):
                    if ultLetra >= parte * (u - 1) and ultLetra < parte * u:
                        numTrozo = u
                        break
        
                num0 = carRandomizar.index(clave2[numTrozo-1])
                if num0 <= carRandomizar.index(clave[numTrozo-1]):
                    num0 += len(carRandomizar)
                num = num0 - carRandomizar.index(clave[numTrozo-1])
                mensajeEncriptado = mensajeEncriptado + str(caracteres[carRandomizar.index(mensaje[a]) + num-1])
            ultLetra += 1 
        
        mensajeEncriptado = "".join(clave2) + " " + mensajeEncriptado
        print(colored("\n[+] Mensaje encriptado: \n", 'green'), colored(str(mensajeEncriptado[::-1]), 'cyan'), "\n") #lo imprime dado la vuelta para hacerlo un poco mas complicado de descifrar
        time.sleep(4)
        
    elif opcion.lower() == "descifrar" or opcion.lower() == "d":
        c1 = input(str(colored("\n[+] Clave: ", 'green')))
        clave = list(c1)
        clave2 = []
        
        mensaje = input(str(colored("[+] Mensaje encriptado: ", 'green')))
        mensaje = list(reversed(mensaje))
        dm = "" #mensaje desencriptado
        
        c = 0
        for i in range(len(clave)):
            clave2.append(mensaje[i-c])
            mensaje.remove(mensaje[i-c])
            c += 1
        mensaje.remove(" ")
        
        for i in range(len(clave)): #desencripta el mensaje por trozos
            pass
        
        print(colored("\n[+] Mensaje desencriptado: \n", 'green'), colored(str(dm), 'cyan'))
    
    else:
        print(colored("\n[!] ERROR: Vuelva a escribir lo que quiere hacer por favor.", 'red'))
