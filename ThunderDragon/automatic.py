# Made by: Airil / Ainhoa

from termcolor import colored

from reconocimiento import *

def configured_auto():
    pass

def auto_config():
    pass

def auto():
    pass

def auto_recognition(mac_change, iface, realMac, whois_, domain, tec_enumeration, port_enum, host, ports, protocol, subdomain, brute, sslcert, directories, url, hc):
    print("")
    if mac_change == "y":
        if realMac == "":
            ifconfig_result = subprocess.check_output(["ifconfig", iface])
            macSearch = re.search(r"\w\w:\w\w:\w\w:\w\w:\w\w:\w\w", str(ifconfig_result))
            if macSearch:
                realMac = macSearch.group(0)
                print(colored("\n[+]", 'green'), "Real MAC:", colored(str(realMac), 'cyan'))
        change_mac(iface)
        
    if whois_ == "y":
        get_whois_info(domain)
        print("")
    
    if tec_enumeration == "y":
        tec_enum(domain)
    
    if port_enum == "y":
        valid_ports = port_scan(host, ports, protocol)
        
        print(colored("\nPORTS:", 'green', attrs=['underline', 'dark']))
        for port, service in valid_ports.items():
            if service:
                print(colored(str(port), 'cyan') + " " + service)
            else:
                print(colored(str(port), 'cyan'))
        
    if subdomain == "y":
        subdomainslist = subdomains(domain, brute, sslcert)
        
        if subdomainslist == []:
            print(colored("\n[!] Subdomains not found!", 'red'))
        else:
            print(colored("\n[+] Subdomains founded!\n", 'green'))
            
            print(colored("SUBDOMAINS\n", 'green', attrs=['dark', 'underline']))
            for i in subdomainslist:
                print(colored(i, 'blue'))
        
    if directories == "y":
        directories_ = dir_fuzzing(url, hc)
        
        print(colored("\nDIRECTORIES:", 'green', attrs=['underline', 'dark']))
        for dir in directories_:
            print(colored(dir, 'cyan'))
                
    if mac_change == "y":
        change_mac(realMac)
    
def configured_recognition():
    pass

def recognition_config():
    pass
