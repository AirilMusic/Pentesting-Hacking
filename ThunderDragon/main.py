# Made by: Airil / Ainhoa

import time
import random

import os
import re
import requests

import subprocess
from subprocess import call

from termcolor import colored

from reconocimiento import subdomains

DN = open(os.devnull, 'w')

print(colored("\n                                                           __====-_        _-====__", 'red', attrs=['blink']),
      colored("\n                                                       _--^^^#####//      \\#####^^^--_", 'red', attrs=['blink']),
      colored("\n                                                    _-^##########// (    ) \\##########^-_", 'red', attrs=['blink']),
      colored("\n                                                   -############//  |\^^/|  \\############-", 'red', attrs=['blink']),
      colored("\n                                                 _/############//   (@::@)   \\############\_", 'red', attrs=['blink']),
      colored("\n                                                ./#############((   \.\/./   ))#############\.", 'red', attrs=['blink']),
      colored("\n                                                -###############\\    (oo)    //###############-", 'red', attrs=['blink']),
      colored("\n                                                -#################\\  /  \  //#################-", 'red', attrs=['blink']),
      colored("\n                                              _#/|##########/\######(    )######/\##########|\#_", 'red', attrs=['blink']),
      colored("\n\n#########   #     #   #     #   #      #   #####    ######   ######         #####    ######     ####     ####     ####    #       #", 'red', attrs=['blink']),
      colored("\n    #       #     #   #     #   # #    #   #    #   #        #     #        #    #   #     #   #    #   #        #    #   # #     #", 'red', attrs=['blink']),
      colored("\n    #       #######   #     #   #   #  #   #    #   ###      ######         #    #   ######    ######   #   ###  #    #   #   #   #", 'red', attrs=['blink']),
      colored("\n    #       #     #   #     #   #    # #   #    #   #        #     #        #    #   #     #   #    #   #    #   #    #   #     # #", 'red', attrs=['blink']),
      colored("\n    #       #     #    #####    #      #   #####    ######   #     #        #####    #     #   #    #    ####     ####    #       #", 'red', attrs=['blink']))

print(colored("\n\n####   ThunderDragon   ####", 'red'))
print(colored("Made by: Airil\n", 'cyan'))
print(colored("I am not responsible for the misuse that may be given to this tool!\n\n", 'red', attrs=['reverse', 'blink', 'dark', 'dark']))

try:
    if os.getuid() == 0:
        ###### CHECKS
        print("\n" + colored("[+]", 'green'), "Checking requeriments... ")
        if str(subprocess.check_output(["which", "searchsploit"])) != "":
            print(colored("[+]", 'green'), "Searchsploit installed")
            print(colored("[-] If you haven't updated Searchsploit recently, please run 'searchsploit -u' to update it.", 'yellow'))
        else:
            print(colored("[-]", 'yellow'), "Instaling searchsploit...")
            call(["sudo", "apt", "update", "&&", "sudo", "apt", "-y", "install", "exploitdb", "-Y"])
            print(colored("[+]", 'green'), "Searchsploit installed")
        
        ###### EJECUCION
        while True:
            text = str(colored("\nThunderDragon", 'blue') + colored(" option > ", 'red'))
            option = input(text).lower()

            if option == "subdomains":
                text = str(colored("\nThunderDragon", 'blue') + colored(" DOMAIN > ", 'red'))
                subdomainslist = subdomains(input(text))
                
                if subdomainslist == []:
                    print(colored("\n[!] Subdomains not found!", 'red'))
                else:
                    print(colored("\n[+] Subdomains founded!\n", 'green'))
                    
                    print(colored("SUBDOMAINS\n", 'green', attrs=['dark', 'underline']))
                    for i in subdomainslist:
                        print(colored(i, 'blue'))
                
    else:
        print("\n" + colored("[!] Login as Root ", 'red') + colored("and try again\n", 'yellow'))

except:
    print(colored("[!]", 'red') + colored(" This tool only work in Linux", 'red'))
print(colored("\n\n####   ThunderDragon   ####", 'red'))
print(colored("Made by: Airil\n", 'cyan'))
print(colored("I am not responsible for the misuse that may be given to this tool!\n\n", 'red', attrs=['reverse', 'blink', 'dark', 'dark']))

try:
    if os.getuid() == 0:
        ###### CHECKS
        print("\n" + colored("[+]", 'green'), "Checking requeriments... ")
        if str(subprocess.check_output(["which", "searchsploit"])) != "":
            print(colored("[+]", 'green'), "Searchsploit installed")
            print(colored("[-] If you haven't updated Searchsploit recently, please run 'searchsploit -u' to update it."))
        else:
            print(colored("[-]", 'yellow'), "Instaling searchsploit...")
            call(["sudo", "apt", "update", "&&", "sudo", "apt", "-y", "install", "exploitdb", "-Y"])
            print(colored("[+]", 'green'), "Searchsploit installed")
            
            
        
    else:
        print("\n" + colored("[!] Login as Root ", 'red') + colored("and try again\n", 'yellow'))

except:
    print(colored("[!]", 'red') + colored(" This tool only work in Linux", 'red'))
